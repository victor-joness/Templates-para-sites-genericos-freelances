/**
 * Atropos 0.9.6
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2021 
 *
 * Released under the MIT License
 *
 * Released on: September 28, 2021
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Atropos=e()}(this,(function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var e=function(t,e){return t.querySelector(e)},o=function(t,e){t.style.transitionDuration=e},a=function(t,e){t.style.transform=e},r=function(t,e){t.style.opacity=e},n=function(t,e,o,a){return t.addEventListener(e,o,a)},i=function(t,e,o,a){return t.removeEventListener(e,o,a)},s=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};return function(c){void 0===c&&(c={});var p,u,d,l,f,v,h,y,m,g,L=c,M=L.el,x=L.eventsEl,_={__atropos__:!0,params:t({activeOffset:50,shadowOffset:50,shadowScale:1,durationEnter:300,durationLeave:600,rotateLock:!0,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},s(c||{})),destroyed:!1,isActive:!1},O=_.params,b=!0,w=!0,T=function(t){var e=t.rotateXPercentage,n=void 0===e?0:e,i=t.rotateYPercentage,s=void 0===i?0:i,c=t.duration,p=t.opacityOnly;(function(t,e){return t.querySelectorAll(e)})(M,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){o(t,c);var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===n&&0===s)p||a(t,"translate3d(0, 0, 0)"),e&&r(t,e[0]);else{var i=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(i)||p||a(t,"translate3d("+-s*-i+"%, "+n*-i+"%, 0)"),e){var u=e[0],d=e[1],l=Math.max(Math.abs(n),Math.abs(s));r(t,u+(d-u)*l/100)}}}))},E=function(t){"pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType||("pointerdown"===t.type&&t.preventDefault(),M.classList.add("atropos-active"),o(p,"0ms"),u=!1,f=void 0,v=void 0,b=!0,w=!0,a(d,"translate3d(0,0, "+O.activeOffset+"px)"),o(d,(O.rotateLock?O.durationEnter:0)+"ms"),y&&o(y,(O.rotateLock?O.durationEnter:0)+"ms"),_.isActive=!0,"function"==typeof O.onEnter&&O.onEnter())},X=function(t){u&&t.cancelable&&t.preventDefault()},Y=function(t){if(O.rotate&&_.isActive){if("mouse"!==t.pointerType){if(!O.rotateTouch)return;t.preventDefault()}var e=t.clientX,r=t.clientY;h||(h=M.getBoundingClientRect());var n=h,i=n.top,s=n.left,c=n.width,d=n.height,l=c/2,y=d/2,g=e-s,L=r-i,x=O.rotateYMax*(g-l)/(c/2)*-1,E=O.rotateXMax*(L-y)/(d/2);O.rotateLock&&(void 0===v&&(v=x,w=!0),void 0===f&&(f=E,b=!0),w&&(v<0&&(x<0&&(x=0),x>0&&(w=!1)),v>0&&(x>0&&(x=0),x<0&&(w=!1))),b&&(f<0&&(E<0&&(E=0),E>0&&(b=!1)),f>0&&(E>0&&(E=0),E<0&&(b=!1)))),E=Math.min(Math.max(-E,-O.rotateXMax),O.rotateXMax),O.rotateXInvert&&(E=-E),x=Math.min(Math.max(-x,-O.rotateYMax),O.rotateYMax),O.rotateYInvert&&(x=-x),"string"!=typeof O.rotateTouch||0===E&&0===x||(u||(u=!0,M.classList.add("atropos-rotate-touch")),t.cancelable&&t.preventDefault()),a(p,"translate3d(0,0,0) rotateX("+E+"deg) rotateY("+x+"deg)");var X=E/O.rotateXMax*100,Y=x/O.rotateYMax*100;m&&(o(m,"0ms"),a(m,"translate3d("+.25*-Y+"%, "+.25*X+"%, 0)"),m.style.opacity=Math.max(Math.abs(X),Math.abs(Y))/100),T({rotateXPercentage:X,rotateYPercentage:Y,duration:"0ms"}),"function"==typeof O.onRotate&&O.onRotate(E,x)}},A=function(t){h=void 0,_.isActive&&(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType||("string"==typeof O.rotateTouch&&u&&M.classList.remove("atropos-rotate-touch"),M.classList.remove("atropos-active"),a(d,"translate3d(0,0, 0px)"),o(d,O.durationLeave+"ms"),y&&o(y,O.durationLeave+"ms"),m&&(o(m,O.durationLeave+"ms"),a(m,"translate3d(0, 0, 0)"),m.style.opacity=0),o(p,O.durationLeave+"ms"),a(p,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),T({duration:O.durationLeave+"ms"}),_.isActive=!1,"function"==typeof O.onRotate&&O.onRotate(0,0),"function"==typeof O.onLeave&&O.onLeave()))},k=function(t){var e=t.target;!M.contains(e)&&e!==M&&_.isActive&&A()};return _.destroy=function(){_.destroyed=!0,i(document,"click",k),i(x,"pointerdown",E),i(x,"pointerenter",E),i(x,"pointermove",Y),i(x,"touchmove",X),i(x,"pointerleave",A),i(x,"pointerup",A),i(x,"lostpointercapture",A),delete M.__atropos__},"string"==typeof M&&(M=e(document,M)),M&&(M.__atropos__||(void 0!==x?"string"==typeof x&&(x=e(document,x)):x=M,Object.assign(_,{el:M}),p=e(M,".atropos-rotate"),d=e(M,".atropos-scale"),l=e(M,".atropos-inner"),M.__atropos__=_)),M&&x&&(O.shadow&&((y=e(M,".atropos-shadow"))||((y=document.createElement("span")).classList.add("atropos-shadow"),g=!0),a(y,"translate3d(0,0,-"+O.shadowOffset+"px) scale("+O.shadowScale+")"),g&&p.appendChild(y)),O.highlight&&function(){var t;(m=e(M,".atropos-highlight"))||((m=document.createElement("span")).classList.add("atropos-highlight"),t=!0),a(m,"translate3d(0,0,0)"),t&&l.appendChild(m)}(),O.rotateTouch&&("string"==typeof O.rotateTouch?M.classList.add("atropos-rotate-touch-"+O.rotateTouch):M.classList.add("atropos-rotate-touch")),e(M,"[data-atropos-opacity]")&&T({opacityOnly:!0}),n(document,"click",k),n(x,"pointerdown",E),n(x,"pointerenter",E),n(x,"pointermove",Y),n(x,"touchmove",X),n(x,"pointerleave",A),n(x,"pointerup",A),n(x,"lostpointercapture",A)),_}}));
//# sourceMappingURL=atropos.min.js.map